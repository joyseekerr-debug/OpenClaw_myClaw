# 18. 条件单与止损单 (Conditional & Stop Orders)

## 概念定义

**条件单**：当预设条件满足时自动触发的交易指令。
**止损单**：特定类型的条件单，价格触及触发价后自动转为市价或限价单执行。

## 条件单类型

### 1. 价格条件单
```
触发逻辑：
├── 价格突破：价格 ≥ 或 ≤ 触发价
├── 涨跌幅触发：涨跌幅 ≥ 或 ≤ 设定值
└── 技术指标触发：如MACD金叉等

示例：
- 突破买入：股价突破50元时自动买入
- 回落卖出：股价跌破20日均线时卖出
```

### 2. 时间条件单
```
触发类型：
├── 定时触发：指定时间自动下单
├── 开盘触发：开盘时自动执行
├── 收盘触发：收盘前自动执行
└── 持仓时间：持有N天后自动平仓

示例：
- 每周一9:30定投某ETF
- 收盘前5分钟平仓当日未止盈头寸
```

### 3. 组合条件单
```
逻辑组合：
├── 与条件：A条件 AND B条件
├── 或条件：A条件 OR B条件
└── 嵌套条件：(A AND B) OR C

示例：
- 股价突破50元 AND 成交量放大2倍 → 买入
- 价格跌破止损价 OR 持仓超过10天 → 卖出
```

## 止损单详解

### 止损单类型

#### 1. 止损市价单 (Stop Market Order)
```
机制：
- 设置触发价格
- 价格触及触发价 → 转为市价单
- 市价单立即以最优价格成交

多头止损示例：
- 买入价：100元
- 止损触发价：95元
- 股价跌至95元 → 转为市价卖出单
- 实际成交价可能是94.8元（滑点）

优点：确保成交
缺点：可能有滑点
```

#### 2. 止损限价单 (Stop-Limit Order)
```
机制：
- 设置触发价格和限价
- 价格触及触发价 → 转为限价单
- 限价单按指定价格或更优价格成交

多头止损示例：
- 买入价：100元
- 止损触发价：95元
- 止损限价：94.5元
- 股价跌至95元 → 转为限价94.5元卖出单

优点：控制成交价格
缺点：可能无法成交（价格跳空）
```

#### 3. 跟踪止损单 (Trailing Stop Order)
```
机制：
- 设置跟踪距离（固定金额或百分比）
- 价格向有利方向移动 → 止损价自动调整
- 价格向不利方向移动 → 止损价不变

多头跟踪止损示例：
- 买入价：100元
- 跟踪距离：5%
- 初始止损价：95元

价格变动：
100 → 105 → 止损价上移至99.75
105 → 110 → 止损价上移至104.50
110 → 108 → 止损价保持104.50
108 → 104 → 触发止损，卖出

优点：让利润奔跑，自动保护收益
缺点：正常回调可能触发止损
```

### 止损单设置要点

#### 触发价选择
```
技术派：
- 支撑位下方
- 趋势线下方
- 均线下方

波动派：
- ATR倍数（2-3倍ATR）
- 固定百分比（5-10%）

资金派：
- 基于风险金额计算
- 单笔最大亏损限制
```

#### 避免常见错误
```
❌ 止损过紧
- 正常波动即触发
- 频繁止损，累积亏损

❌ 止损过宽
- 单次亏损过大
- 难以回本

❌ 整数关口止损
- 10.00元止损易被触发
- 建议9.98或9.95

❌ 移动止损过慢
- 已获利润大幅回吐
- 建议盈利后及时上移
```

## 条件单与止损单应用

### 入场策略

#### 突破入场
```
条件单设置：
- 标的：某股票
- 触发条件：价格突破50元
- 执行：市价买入1000股
- 有效期：GTC（撤销前有效）

逻辑：
- 等待突破确认
- 避免假突破风险
- 无需盯盘
```

#### 回调入场
```
条件单设置：
- 触发条件：价格回调至20日均线
- 执行：限价买入

逻辑：
- 趋势中的健康回调买入
- 自动执行，避免情绪化
```

### 离场策略

#### 括号订单 (OCO - One Cancels Other)
```
结构：
- 建仓同时设置两个条件单
- 止盈单：达到目标盈利
- 止损单：达到最大亏损
- 一个成交，另一个自动取消

示例：
- 买入价：100元
- 止盈：110元（+10%）
- 止损：95元（-5%）
- 任意一个触发，另一个自动撤销
```

## 条件单平台实现

### 主流券商支持
```
国内券商：
- 条件单功能基本普及
- 支持价格、时间条件
- 部分支持技术指标条件

国际券商：
- Interactive Brokers：功能全面
- TD Ameritrade：thinkorswim平台强大
- Robinhood：基础条件单
```

### 自建条件单系统
```
技术方案：
- 行情数据实时接收
- 条件判断引擎
- 自动下单执行
- 状态监控与通知

注意事项：
- 网络稳定性
- 订单状态确认
- 异常处理机制
```

---
*文档版本：v1.0 | 投资技能学习系列*
