# 33. 预警算法设计 (Alert Algorithm Design)

## 概念定义

预警算法是指根据预设规则和条件，自动检测异常状态并生成预警通知的计算逻辑。好的预警算法需要平衡灵敏度和准确度，避免漏报和误报。

## 预警算法类型

### 1. 阈值算法（Threshold-based）
```
原理：
- 设定上下限阈值
- 超过阈值即触发

公式：
Alert = True if (Value > Upper_Threshold) or (Value < Lower_Threshold)

优点：
- 简单直观
- 易于理解和配置
- 计算效率高

缺点：
- 对噪音敏感
- 可能频繁触发
- 无法识别趋势变化

优化：
- 设置持续时间（如连续3分钟超限）
- 设置触发次数（如1小时内最多3次）
- 动态阈值（根据波动率调整）
```

### 2. 变化率算法（Rate of Change）
```
原理：
- 监控变化速度
- 快速变化触发预警

公式：
ROC = (Current - Previous) / Previous × 100%
Alert = True if |ROC| > Threshold

应用：
- 价格急涨急跌预警
- 成交量突变预警
- 波动率异常变化

参数：
- 时间窗口：1分钟、5分钟、15分钟
- 阈值：±2%、±5%、±10%
```

### 3. 统计异常检测（Statistical Anomaly）
```
原理：
- 基于历史统计分布
- 偏离正常范围触发

方法1：Z-Score
Z = (X - μ) / σ
Alert = True if |Z| > 3（3σ原则）

方法2：分位数
Alert = True if X > 95th percentile or X < 5th percentile

方法3：移动平均偏离
Deviation = (X - MA) / MA
Alert = True if |Deviation| > Threshold

优点：
- 自适应市场变化
- 考虑历史规律
- 减少主观设定

缺点：
- 需要足够历史数据
- 极端行情可能失效
```

### 4. 模式识别算法（Pattern Recognition）
```
原理：
- 识别特定K线形态
- 识别技术形态

K线形态：
- 锤子线、十字星、吞没形态
- 连续N日上涨/下跌
- 缺口形态

技术形态：
- 头肩顶/底
- 双顶/双底
- 三角形整理
- 旗形/楔形

实现：
- 规则引擎
- 机器学习分类
- 形态匹配算法
```

### 5. 多条件组合算法
```
原理：
- 多个条件同时满足才触发
- 提高预警准确度

逻辑组合：
AND条件（同时满足）：
Alert = Condition_A AND Condition_B AND Condition_C

OR条件（任一满足）：
Alert = Condition_A OR Condition_B

加权评分：
Score = w1×C1 + w2×C2 + w3×C3
Alert = True if Score > Threshold

示例：
买入信号 = 金叉 AND 放量 AND RSI<70
卖出信号 = 死叉 OR (跌破支撑 AND 放量)
```

## 预警算法设计原则

### 1. 明确预警目标
```
目标分类：
- 风险预警：防止损失
- 机会预警：把握时机
- 系统预警：技术故障

不同目标不同策略：
- 风险预警：宁可误报，不可漏报
- 机会预警：宁可漏报，不可误报
- 系统预警：实时性优先
```

### 2. 平衡灵敏度与特异度
```
灵敏度（Sensitivity）：
- 真实异常被检测出的比例
- 高灵敏度 → 少漏报

特异度（Specificity）：
- 正常状态不被误报的比例
- 高特异度 → 少误报

权衡：
- 根据预警成本调整
- 高风险场景提高灵敏度
- 高误报成本提高特异度
```

### 3. 防止预警疲劳
```
问题：
- 预警过多导致忽视
- 重要预警被淹没

解决：
- 分级管理（紧急/重要/一般）
- 聚合通知（同类预警合并）
- 智能去重（重复条件只报一次）
- 静默时段（非交易时间减少预警）
```

## 预警算法优化

### 滞后处理
```
问题：
- 数据波动导致频繁触发

解决：
- 触发确认（持续N周期才触发）
- 触发冷却（触发后M分钟内不再触发）
- 触发计数（N次满足才触发）
```

### 自适应调整
```
原理：
- 根据市场环境动态调整参数

实现：
- 波动率高时放宽阈值
- 波动率低时收紧阈值
- 根据历史触发频率调整
```

### 机器学习优化
```
监督学习：
- 历史预警结果标注
- 训练分类模型
- 预测预警有效性

异常检测：
- 无监督学习识别异常模式
- 自动调整预警规则

强化学习：
- 根据反馈优化预警策略
- 平衡预警收益与成本
```

---
*文档版本：v1.0 | 投资技能学习系列*
