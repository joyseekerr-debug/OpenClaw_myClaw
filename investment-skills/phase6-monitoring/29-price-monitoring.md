# 29. 价格监控策略 (Price Monitoring Strategy)

## 概念定义

价格监控是指对目标标的的价格变动进行实时跟踪，并在价格达到预设条件时触发预警的监控策略。它是实时监控系统的核心功能之一。

## 价格监控类型

### 1. 绝对价格监控
```
监控目标：具体价格点位

应用场景：
├── 目标价到达
│   └── 止盈/目标价位监控
├── 止损价触发
│   └── 风险控制价位
├── 关键技术支持/阻力位
│   └── 10元整数关口、前期高点等
└── 成本价附近
    └── 保本/回本提醒

设置示例：
- 标的：贵州茅台
- 当前价：1700元
- 目标价：1800元（止盈）
- 止损价：1600元（止损）
- 监控方向：双向
```

### 2. 涨跌幅监控
```
监控目标：相对价格变动幅度

应用场景：
├── 日内涨跌停预警
│   └── 接近±10%时提醒
├── 异常波动预警
│   └── 日内涨跌超5%
├── 涨速/跌速过快
│   └── 5分钟内涨跌超2%
└── 连续涨跌天数
    └── 连续3日上涨/下跌

设置示例：
- 标的：某科技股
- 监控条件：5分钟内涨跌幅≥3%
- 预警级别：重要
- 通知方式：飞书+短信
```

### 3. 价格区间监控
```
监控目标：价格在区间内的位置

应用场景：
├── 突破区间
│   └── 突破近期震荡平台
├── 回到区间
│   └── 突破后回踩确认
├── 区间内部位置
│   └── 接近区间上下轨
└── 布林带位置
    └── 触及上轨/下轨

设置示例：
- 标的：某ETF
- 近期区间：2.50-2.80元
- 监控：
  - 突破2.80元 → 突破预警
  - 跌破2.50元 → 跌破预警
  - 触及2.65元（中轨）→ 中性提醒
```

## 价格监控参数

### 监控精度
```
Tick级监控：
- 每笔成交都检查
- 最高精度
- 资源消耗大
- 适合高优先级标的

定时轮询：
- 每秒/每5秒检查
- 精度足够
- 资源效率平衡
- 适合一般监控

K线触发：
- 每根K线结束检查
- 适合技术分析
- 低频但稳定
```

### 触发条件
```
单边触发：
- 价格 ≥ 目标价
- 价格 ≤ 目标价
- 适合单一方向监控

双边触发：
- 价格触及任一方向
- 适合区间监控
- 同时监控突破上下

持续触发 vs 单次触发：
- 持续：只要条件满足就提醒
- 单次：仅第一次触发提醒
- 推荐单次+重置机制
```

## 价格监控策略设计

### 分层监控
```
第一层：核心持仓
- 监控频率：实时
- 监控粒度：精确到分
- 预警阈值：严格（±1%）
- 通知方式：即时推送

第二层：关注标的
- 监控频率：分钟级
- 监控粒度：到角/分
- 预警阈值：中等（±3%）
- 通知方式：应用推送

第三层：观察列表
- 监控频率：小时级
- 监控粒度：到元
- 预警阈值：宽松（±5%）
- 通知方式：日报汇总
```

### 智能监控
```
自适应阈值：
- 根据波动率调整阈值
- 高波动期放宽阈值
- 低波动期收紧阈值

时间加权：
- 开盘时段更敏感
- 收盘时段重点监控
- 盘中适当放宽

相关标的一并监控：
- 正股监控时同步监控期权
- 监控ETF时关注成分股
- 监控A股时关注港股/ADR
```

## 价格监控实现

### 技术方案
```
方案1：轮询检查
while True:
    for symbol in watchlist:
        if check_price_trigger(symbol):
            send_alert(symbol)
    sleep(interval)

方案2：事件驱动
on_price_update(symbol, price):
    if price in alert_conditions[symbol]:
        send_alert(symbol, price)

方案3：数据库触发
- 价格数据写入时触发存储过程
- 检查预警条件
- 满足则插入预警表
```

### 注意事项
```
⚠️ 重复预警问题
- 单次触发后标记已触发
- 价格离开触发区后重置
- 避免连续轰炸

⚠️ 价格跳跃问题
- 设置最小变动单位
- 考虑跳空情况
- 跳空穿过阈值也需触发

⚠️ 盘后数据问题
- 区分盘中/盘后价格
- 盘后大宗交易单独处理
- 隔夜跳空单独设置
```

---
*文档版本：v1.0 | 投资技能学习系列*
